upstream gunicorn_supp_server {
    server 0.0.0.0:52015;
    server 0.0.0.0:52016;
    server 0.0.0.0:52017;

}


upstream gunicorn_reduce_server {
    server 0.0.0.0:51011;
}


server {
        listen 52011;
        server_name _;
        proxy_send_timeout 120s;
        proxy_read_timeout 120s;

        location /supp_reduction {
                proxy_pass http://gunicorn_supp_server;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $host;
                proxy_headers_hash_max_size 51200;
                proxy_headers_hash_bucket_size 6400;
                proxy_send_timeout 180;
                proxy_read_timeout 180;
                client_max_body_size  150m;
        }

        location /reduce {
                proxy_pass http://gunicorn_reduce_server;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $host;
                proxy_headers_hash_max_size 51200;
                proxy_headers_hash_bucket_size 6400;
                proxy_send_timeout 180;
                proxy_read_timeout 180;
                client_max_body_size  150m;
        }

}
